<html>
<head>
    <title>Shop</title>
    <link rel="icon" type="image/x-icon" href="https://em-content.zobj.net/thumbs/120/twitter/348/doughnut_1f369.png">
</head>
<body>
    <dialog id="merchant">
        <div id="dawg">
            <img style="width: 100%;" src="https://lh3.googleusercontent.com/pw/AP1GczNb-wJCo34-pilI2PLq5QwFcp-8EqImI_Q2_ZGy_xgZd-rgd4YHwAh4BBrYPAc2cpQfRdQxizZ1Vjfwjit6bKrTNJHdae5Bpm3iJh1wik6EDoYJGKk=w2400">
            <p class="merchant"><u>psst... Check the catalog before buying!</u></p>
        </div>
        <div id="shop">
            <p id="p123" class="merchant">Sprinkles:</p>
            <p id="points">300</p>
            <p class="merchant">Base Level:</p>
            <p class="merchant" id="basepoints">2</p>
            <button class="purchase" id="purchasebutton2">Buy a chair: Costs 300 sprinkles, Adds 1 Base Level</button>
            <br><br>
            <button class="purchase" id="purchasebutton3">Buy a shelf: Costs 600 sprinkles, Adds 1 Base Level</button>
            <br><br>
            <button class="purchase" id="purchasebutton4">Buy a table: Costs 900 sprinkles, Adds 1 Base Level</button>
            <br><br>
            <button class="purchase" id="purchasebutton5">Buy a Chest: Costs 2500 sprinkles, Adds 2 Base Level</button>
            <br><br>
            <button class="purchase" id="purchasebutton6">Buy a Computer: Costs 2800 sprinkles, Adds 2 Base Level</button>
            <br><br>
            <button class="purchase" id="purchasebutton7">Buy a Bed: Costs 3200 sprinkles, Adds 2 Base Level</button>
        </div>
    </dialog>
    <dialog id="catalog">
        <h1 style="text-align: center;">CATALOG:</h1>
        <div>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczOLSXepGfxAxvjPjzBGZeIJdeDDanbmS97DoCIY7A6ewv6QtDGjlb0SYsY65PdubMxXHyJ4bIiwMZd66EF45SeCq9LYHHMcjIhKuIcdl83hBGZkXoc=w2400">
            <p>Simple Chair: 300 sprinkles</p>
            <p>why is it facing the other direction</p>
        </div>
        <div>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczMw1sUX2KTr_3jdaiLKe9ckKQK_e0h4RbJVRHKSfFkAyVtNzEezpQP6xFXCQdONZPnCV5Dv8QaEx4dflEm6Ge3R0ufeqCgpHOyp0aYIE5-3p1e57LY=w2400">
            <p>Empty Shelf: 600 sprinkles</p>
            <p>You can add more stuff to it down the road</p>
        </div>
        <div>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczM3EftK6B40enEbXdc6IaM-bEd8aW-UTGwPNT0S8TeEh7XH7s0EJrtbzfmSDqW-aVpAaFyhSQxvZ6x2tchOKj9JWHJpp0to-HJgm3rCOFhTazGgIcw=s274-p-k">
            <p>Table: 900 sprinkles</p>
            <p>yeah i know, why is this simple table so expensive</p>
        </div>
        <div>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczOYJkg3eCQgTSpgMrxiaGoLQZjZHM8K0A0TdIQHE9Wz1OA7ZDJnSz0j94CYi_2eZBnCJlLUPRIWtEXf7BEZJ-YhcW7fXHH0usvm-Ldn4i6vqeIw7EE=w2400">
            <p>Chest: 2500 Sprinkles</p>
            <p style="font-size: 20px;"><i>I swear I am gonna rework its look later I swear just leave me alone</i></p>
            <p>Show off your wealth using this item where other players visiting your base can click on it to see your items!</p>
        </div>
        <div>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczPrOiHac3-5OdPwvE4c1tileIdP_BbPsyMaCnxveWWgiKte8jXABX865wptpRXFcoULl6pCN46EBd6-7_Nac5nJj_aXixpBXmIKfgXXuy4RqTm3FzU=w2400">
            <p>Computer: 2800 Sprinkles</p>
            <p style="font-size: 20px;">Are you seriously gonna keep this thing on the floor</p>
            <p>Access the donut internet! and other apps</p>
        </div>
        <div>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczOPh-kYneIGWvobra_jCeSSJik6ixPLD1p7T21lgpqgqPb1lCJENGA9Ypm1W1o2zlYatavgeESbrF37I2G2XuoV92qbxjacj2PgN99J5eUWyi8qFfo=w2400">
            <p>Bed: 3200 Sprinkles</p>
            <p style="font-size: 20px;">sweet they are giving you the pillow for free</p>
            <p>Restores energy between 3-8 energy bars</p>
        </div>
        <!--Dont forget to add the bed!!!!-->
    </dialog>
    <dialog id="itemshop">
        <h1 style=" color: #F5DD90;">Item Shop</h1>
        <p>Sprinkles:</p>
       <p id="points2">5</p>
       <p>Energy:</p>
        <p id="energypoints">8</p>
        <div>
            <h1>Donut Delight</h1>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczOo15pQPuwsUVMZujmeTQ1aTCw25kErSVznSZyrvbDX-2WvGDI36mGTP0GGR_5Qhx_tDmy-I__jALlFdj8RVKe7zqWk1cTzGVhAraSPXq5WoaDPiCVS=w2400">
            <p>Restores 1 energy</p>
            <button class="purchase" id="buyingbutton">100 sprinkles</button>
        </div>
        <div>
            <h1>Expired sleeping pills</h1>
            <img src="https://lh3.googleusercontent.com/pw/AP1GczNxtynVgt_uJTWoqZJrFEknZ9Y5q9frWsPnbWbwtKTIPLxvb3VJD7A1ZvfVjhpcTMIJb6_E78Kbkp6FFglacIrxSQS-PjQSD5Vsaig4FStSHbyNE0Lz=w2400">
            <p>I guess they should make you sleepy?</p>
            <button class="purchase" id="buyingbutton5">300 sprinkles</button>
        </div>
        <div>
            <h1>Soda Bob</h1>
            <img src="sodabob.gif">
            <p>"can i dr-" <br>
                 "NO YOU CAN'T DRINK IT, ITS LTIERALLY LIVING YOU MONSTER"</p>
                 <button class="purchase" id="buyingbutton2">800 sprinkles</button>
        </div>
        <div>
            <h1>Donut</h1>
            <img src="donut .gif">
            <p> Don't ask why the hole looks weird.</p>
                 <button class="purchase" id="buyingbutton3">2000 sprinkles</button>
        </div>
        <div>
            <h1>Prism Heart</h1>
            <img src="hp.gif">
            <p>"so you are telling me there is a prism dimension outside of this donut dimension? nah that has to be fake"
                <br>
                "bro its real I promise"
                <br>
                "THERE IS NO SUCH THING AS A PRISM DIMENSION"
            </p>
                 <button class="purchase" id="buyingbutton4">5000 sprinkles</button>
        </div>
        <p>I wasnt supposed to make past 2555</p>
    </dialog>
</body>
<style>
    h1 {
        font-family: simp;
       
    }
    #itemshop {
        background-color: #F88379;
        font-family: comic;
        font-size: 25px;
        color: #324376;
        width: 700px;
        height: 700px;
        border: none;
        border-radius: 10px;
    }
    #catalog {
        border: none;
        width: 700px;
        height: 700px;
        border-radius: 10px;
        background-color: #6B9AC4;
        color: #EFF2F1;
        font-family: comic;
        font-size: 25px;
    }
    .purchase {
        border: none;
        cursor: pointer;
        background-color: #362c28;
        color: #EDFF86;
        width: 100%;
        height: 100px;
        font-family: comic;
        font-size: 40px;
    }
    #dawg {
        width: 100%;
    }
    #shop {
        width: 100%;
    }
    @keyframes colorChange {
        0% { color: #FFD700; }
        25% { color: #FF6B00; }
        50% { color: #0038A8; }
        75% { color: #FF0000; }
        100% { color: #00BFFF; }
    }
    #points, #points2 {
        font-family: Simp;
        animation: colorChange 2s linear infinite;
        font-size: 30px;
    }
    @font-face {
        font-family: Simp;
        src: url(simpson.otf);
    }
    @font-face {
        font-family: comic;
        src: url(comic.otf);
    }
    .merchant {
        font-family: comic;
        color: #C5283D;
        font-size: 30px;
    }
    #merchant {
        border: none;
        width: 700px;
        height: 700px;
        border-radius: 10px;
        background-color: #ffc857;
    }
</style>
<script type="module">
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.159.0/build/three.module.js';

    var scene, camera, renderer, cube, floor, torus, torus2, torus3;
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2();

    function init() {
        scene = new THREE.Scene();
        const aspect = window.innerWidth / window.innerHeight;
        const frustumSize = 2200;
        camera = new THREE.OrthographicCamera(
            frustumSize * aspect / -2, frustumSize * aspect / 2,
            frustumSize / 2, frustumSize / -2,
            0.1, 5000
        );
        camera.position.set(1000, 1000, 1000);
        camera.lookAt(scene.position);

        renderer = new THREE.WebGLRenderer({ alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x9FD3BF, 1);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);

        const light = new THREE.DirectionalLight(0xffffff, 3);
        light.position.set(100, 200, 100);
        light.castShadow = true;
        light.shadow.bias = -0.02005;
        scene.add(light);

        light.shadow.mapSize.width = 2048;
        light.shadow.mapSize.height = 2048;
        light.shadow.camera.near = 0.5;
        light.shadow.camera.far = 2000;

        light.shadow.camera.left = -1000;
        light.shadow.camera.right = 1000;
        light.shadow.camera.top = 1000;
        light.shadow.camera.bottom = -1000;

        var floorGeometry = new THREE.PlaneGeometry(2000, 2000, 8, 8);
        var loader = new THREE.TextureLoader();
        var base64ImageFloor = 'https://t4.ftcdn.net/jpg/02/40/93/69/360_F_240936998_2wBjelIOKw1vGKkfOpCjiA25waBAiLeb.jpg';
        var base64ImageWall = 'https://as2.ftcdn.net/v2/jpg/03/96/55/53/1000_F_396555322_A97RVgCKvX5ZDnI5Bpe3R6THyLdFmmhm.jpg';
        loader.load(base64ImageFloor, function (floorTexture) {
            var floorMaterial = new THREE.MeshLambertMaterial({ map: floorTexture, side: THREE.DoubleSide });
            floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.receiveShadow = true;
            scene.add(floor);
        });

        var cubeGeometry = new THREE.BoxGeometry(100, 100, 100);
        var base64ImageCube = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcREDuhZaj-ipYZI3SBRGTWDvKJlEQZG7-vHX5Ce-bhMLQ&s';

        loader.load(base64ImageCube, function (cubeTexture) {
            var cubeMaterial = new THREE.MeshLambertMaterial({ map: cubeTexture });
            cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
            cube.position.set(-150, 150, 0);
            cube.castShadow = true;
          
        });

        var wallHeight = 400;
        var wallMaterial = new THREE.MeshLambertMaterial({ color: 0xcccccc });

        loader.load(base64ImageWall, function (wallTexture) {
            var wallMaterial = new THREE.MeshLambertMaterial({ map: wallTexture });

            var leftWallGeometry = new THREE.PlaneGeometry(2000, wallHeight);
            var leftWall = new THREE.Mesh(leftWallGeometry, wallMaterial);
            leftWall.position.set(-1000, wallHeight / 2, 0);
            leftWall.rotation.y = Math.PI / 2;
            leftWall.receiveShadow = true;
            scene.add(leftWall);

            var backWallGeometry = new THREE.PlaneGeometry(2000, wallHeight);
            var backWall = new THREE.Mesh(backWallGeometry, wallMaterial);
            backWall.position.set(0, wallHeight / 2, -1000);
            backWall.receiveShadow = true;
            scene.add(backWall);
        });

        const torusGeometry = new THREE.TorusGeometry(50, 25, 26, 100);
        const torusMaterial = new THREE.MeshLambertMaterial({ color: 0xff69b4 });
        torus = new THREE.Mesh(torusGeometry, torusMaterial);
        torus.position.set(150, 150, 0);
        torus.castShadow = true;
        scene.add(torus);
        const torus2Material = new THREE.MeshLambertMaterial({color: 0xADD8E6});
        torus2 = new THREE.Mesh(torusGeometry, torus2Material)
        torus2.position.set(-350, 150, -400);
        torus2.castShadow = true;
        scene.add(torus2);
        const torus3Material = new THREE.MeshLambertMaterial({color: 0xF76C5E});
        torus3 = new THREE.Mesh(torusGeometry, torus3Material)
        torus3.position.set(-350, 150, 200);
        torus3.castShadow = true;
        scene.add(torus3);

        function onMouseClick(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(scene.children);

            for (let i = 0; i < intersects.length; i++) {
                if (intersects[i].object === cube) {
                    onCubeClick();
                }
                else if (intersects[i].object === torus) {
                    onTorusClick();
                }
                else if (intersects[i].object === torus2) {
                    onTorus2Click();
                }
                else if (intersects[i].object === torus3) {
                    onTorus3Click();
                }
            }
        }
        window.addEventListener('click', onMouseClick, false);
        function onTorus3Click() {
            document.getElementById('itemshop').showModal();
        }
        function onTorus2Click() {
            document.getElementById('catalog').showModal();
        }
        function onTorusClick() {
            document.getElementById('merchant').showModal();
        }
        function onCubeClick() {
            alert('Cube clicked!');
        }
        animate();
    }

    function animate() {
        requestAnimationFrame(animate);

        if (cube) {
            cube.rotation.y += 0.01;
            cube.rotation.z += 0.01;
        }
        if (torus) {
            torus.rotation.y += 0.01;
            torus.rotation.x += 0.01;
            torus2.rotation.y += 0.01;
            torus2.rotation.x += 0.01;
            torus3.rotation.y += 0.01;
            torus3.rotation.x += 0.01;
        }
        renderer.render(scene, camera);
    }

    document.addEventListener('keydown', function (event) {
        switch (event.key) {
            case 'w':
            case 'W':
                camera.position.z -= 8;
                break;
            case 's':
            case 'S':
                camera.position.z += 8;
                break;
            case 'a':
            case 'A':
                camera.position.x -= 8;
                break;
            case 'd':
            case 'D':
                camera.position.x += 8;
                break;
            case 'e':
            case 'E':
                camera.position.y += 8;
                break;
            case 'q':
            case 'Q':
                camera.position.y -= 8;
                break;
            case 'ArrowLeft':
                camera.rotation.y += 0.05;
                break;
            case 'ArrowRight':
                camera.rotation.y -= 0.05;
                break;
            case 'ArrowUp':
                camera.rotation.x += 0.05;
                break;
            case 'ArrowDown':
                camera.rotation.x -= 0.05;
                break;
        }
        renderer.render(scene, camera);
    });

    init();

    var pointsElement = document.getElementById('points');
    var pointsElement2 = document.getElementById('points2');
    var baseLevelElement = document.getElementById('basepoints');
    var points = parseInt(pointsElement.textContent);
    var baseLevel = parseInt(baseLevelElement.textContent);
    var energyElement = document.getElementById('energypoints');
    var energy = parseInt(energyElement.textContent);

    function loadPoints() {
        const savedPoints = localStorage.getItem('points1');
        if (savedPoints) {
            pointsElement.innerText = savedPoints;
            pointsElement2.innerText = savedPoints;
            points = parseInt(savedPoints);
        }

        
        const savedEnergy = localStorage.getItem('energy1');
        if (savedEnergy) {
            energyElement.innerText = savedEnergy;
            energy = parseInt(savedEnergy);
        }
    }

    function loadBaseLevel() {
        const savedBaseLevel = localStorage.getItem('baseLevel');
        if (savedBaseLevel) {
            baseLevelElement.innerText = savedBaseLevel;
            baseLevel = parseInt(savedBaseLevel);
        }
    }

    loadPoints();
    loadBaseLevel();

    document.getElementById('purchasebutton2').onclick = () => {
        if (localStorage.getItem('chaircheck')) {
            alert('You already bought this chair.');
            return;
        }
        if (points >= 300) {
            points -= 300;
            pointsElement.innerText = points;
            localStorage.setItem('points1', points.toString());

            localStorage.setItem('chaircheck', 'true');
            baseLevel += 1;
            baseLevelElement.innerText = baseLevel;
            localStorage.setItem('baseLevel', baseLevel.toString());
        } else {
            alert('Not enough sprinkles');
        }
    };

    document.getElementById('purchasebutton3').onclick = () => {
        if (localStorage.getItem('shelfcheck')) {
            alert('You already bought this shelf.');
            return;
        }
        if (points >= 600) {
            points -= 600;
            pointsElement.innerText = points;
            localStorage.setItem('points1', points.toString());

            localStorage.setItem('shelfcheck', 'true');
            baseLevel += 1;
            baseLevelElement.innerText = baseLevel;
            localStorage.setItem('baseLevel', baseLevel.toString());
        } else {
            alert('Not enough sprinkles');
        }
    };

    document.getElementById('purchasebutton4').onclick = () => {
        if (localStorage.getItem('tablecheck')) {
            alert('You already bought this table.');
            return;
        }
        if (points >= 900) {
            points -= 900;
            pointsElement.innerText = points;
            localStorage.setItem('points1', points.toString());

            localStorage.setItem('tablecheck', 'true');
            baseLevel += 1;
            baseLevelElement.innerText = baseLevel;
            localStorage.setItem('baseLevel', baseLevel.toString());
        } else {
            alert('Not enough sprinkles');
        }
    };

    
    document.getElementById('purchasebutton5').onclick = () => {
        if (localStorage.getItem('chestcheck')) {
            alert('You already bought this chest.');
            return;
        }
        if (points >= 2500) {
            points -= 2500;
            pointsElement.innerText = points;
            localStorage.setItem('points1', points.toString());

            localStorage.setItem('chestcheck', 'true');
            baseLevel += 2;
            baseLevelElement.innerText = baseLevel;
            localStorage.setItem('baseLevel', baseLevel.toString());
        } else {
            alert('Not enough sprinkles');
        }
    };

    document.getElementById('purchasebutton6').onclick = () => {
        if (localStorage.getItem('computercheck')) {
            alert('You already bought this computer.');
            return;
        }
        if (points >= 2800) {
            points -= 2800;
            pointsElement.innerText = points;
            localStorage.setItem('points1', points.toString());

            localStorage.setItem('computercheck', 'true');
            baseLevel += 2;
            baseLevelElement.innerText = baseLevel;
            localStorage.setItem('baseLevel', baseLevel.toString());
        } else {
            alert('Not enough sprinkles');
        }
    };
    document.getElementById('purchasebutton7').onclick = () => {
        if (localStorage.getItem('bedcheck')) {
            alert('You already bought this bed.');
            return;
        }
        if (points >= 3200) {
            points -= 3200;
            pointsElement.innerText = points;
            localStorage.setItem('points1', points.toString());

            localStorage.setItem('bedcheck', 'true');
            baseLevel += 2;
            baseLevelElement.innerText = baseLevel;
            localStorage.setItem('baseLevel', baseLevel.toString());
        } else {
            alert('Not enough sprinkles');
        }
    };
    document.getElementById('buyingbutton').onclick = () => {
        if (points >= 100) {
            points -= 100;
            pointsElement2.innerText = points;
            localStorage.setItem('points1', points.toString());
            energy += 1
            energyElement.innerText = energy;
            
            localStorage.setItem('energy1', energy);
            alert('Energy Restored By 1')
        } else {
            alert('Not enough sprinkles');
        }
    };
    document.getElementById('buyingbutton2').onclick = () => {
        if (localStorage.getItem('sodabobcheck')) {
            alert('ok now you are getting greedy, you can only have 1 soda bob!!!');
            return;
        }
        if (points >= 800) {
            points -= 800;
            pointsElement2.innerText = points;
            localStorage.setItem('points1', points.toString());
            localStorage.setItem('sodabobcheck', 'true');
            alert('Soda bob is now in your inventory, give him fresh air from time to time!')
        } else {
            alert('Not enough sprinkles');
        }
    };
    document.getElementById('buyingbutton3').onclick = () => {
        if (localStorage.getItem('donutcheck')) {
            alert('The Donut Matrix Does Not Allow You to Have More Than One Donut');
            return;
        }
        if (points >= 2000) {
            points -= 2000;
            pointsElement2.innerText = points;
            localStorage.setItem('points1', points.toString());
            localStorage.setItem('donutcheck', 'true');
            alert('You now own a donut, do not let it tallk you into eating it please')
        } else {
            alert('Not enough sprinkles');
        }
    };
    document.getElementById('buyingbutton4').onclick = () => {
        if (localStorage.getItem('heartcheck')) {
            alert('NO MORE PRISM SOULS SHALL BE HARMED FOR YOUR PLEASURE!!!');
            return;
        }
        if (points >= 5000) {
            points -= 5000;
            pointsElement2.innerText = points;
            localStorage.setItem('points1', points.toString());
            localStorage.setItem('heartcheck', 'true');
            alert('Sometimes you really should ask yourself who your money is going to. How did they get this thing in the first place??')
        } else {
            alert('Not enough sprinkles');
        }
    };
    document.getElementById('buyingbutton5').onclick = () => {

        if (points >= 300) {
            points -= 300;
            pointsElement2.innerText = points;
            localStorage.setItem('points1', points.toString());
            let chance = Math.random();
                if (chance < 0.35) {
                    localStorage.removeItem('alreadysleptcheck');
                    alert('they worked?? you actually kinda sleepy');
                } else {
                    alert('you still feel like you can a marathon... TWICE');
                }
           
        } else {
            alert('Not enough sprinkles');
        }
    };

    document.addEventListener('keydown', function(event) {
    if (event.key === 'H' || event.key === 'h') {
        window.location.href = 'map.html';
    }
});
</script>
</html>
